// ==UserScript==
// @name          KG_Latest_Games
// @namespace     klavogonki
// @version      1.0.9
// @description   Fast game creation buttons on all the pages
// @match         *://klavogonki.ru/*
// @author        Patcher
// @icon          https://www.google.com/s2/favicons?sz=64&domain=klavogonki.ru
// ==/UserScript==

(()=>{"use strict";var e={56:(e,t,a)=>{e.exports=function(e){var t=a.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function a(e){for(var a=-1,s=0;s<t.length;s++)if(t[s].identifier===e){a=s;break}return a}function s(e,s){for(var r={},i=[],o=0;o<e.length;o++){var l=e[o],g=s.base?l[0]+s.base:l[0],m=r[g]||0,c="".concat(g," ").concat(m);r[g]=m+1;var d=a(c),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(h);else{var p=n(h,s);s.byIndex=o,t.splice(o,0,{identifier:c,updater:p,references:1})}i.push(c)}return i}function n(e,t){var a=t.domAPI(t);a.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;a.update(e=t)}else a.remove()}}e.exports=function(e,n){var r=s(e=e||[],n=n||{});return function(e){e=e||[];for(var i=0;i<r.length;i++){var o=a(r[i]);t[o].references--}for(var l=s(e,n),g=0;g<r.length;g++){var m=a(r[g]);0===t[m].references&&(t[m].updater(),t.splice(m,1))}r=l}}},100:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(601),n=a.n(s),r=a(314),i=a.n(r)()(n());i.push([e.id,'#latest-games-container{display:flex;flex-direction:column;font-family:"Montserrat",sans-serif;position:fixed;top:50px;width:auto;min-width:200px;max-width:350px;max-height:calc(100vh - 100px);background-color:var(--rg-bg-primary);border:1px solid var(--rg-border-primary);border-left:none;border-radius:0 8px 8px 0 !important;box-shadow:2px 0 10px rgba(0,0,0,.1);z-index:3000;padding:10px 0;opacity:0;pointer-events:none;user-select:none;transition:left .3s ease,opacity .3s ease;overflow-y:auto;overflow-x:hidden;scrollbar-width:none;color:var(--rg-text-primary)}#latest-games-container.light-theme{--rg-bg-primary:#fff;--rg-bg-secondary:hsl(0,0%,98%);--rg-bg-card:hsl(0,0%,98%);--rg-bg-card-pinned:hsl(120,50%,96%);--rg-bg-hover:hsl(0,0%,96%);--rg-border-primary:hsl(0,0%,88%);--rg-border-hover:hsl(0,0%,74%);--rg-border-pinned:hsl(122,39%,49%);--rg-text-primary:hsl(0,0%,15%);--rg-text-secondary:#666;--rg-text-tertiary:hsl(0,0%,55%);--rg-text-options:hsl(0,0%,30%);--rg-text-count:hsl(0,0%,15%);--rg-gametype-voc:hsl(215,75%,50%);--rg-gametype-normal:hsl(130,50%,30%);--rg-gametype-abra:hsl(215,20%,40%);--rg-gametype-referats:hsl(80,55%,30%);--rg-gametype-noerror:hsl(200,45%,35%);--rg-gametype-marathon:hsl(340,65%,45%);--rg-gametype-chars:rgb(153,89.25,0);--rg-gametype-digits:hsl(0,0%,50%);--rg-gametype-sprint:hsl(5,40%,40%);--rg-icon-primary:currentColor;--rg-icon-pin:hsl(122,39%,49%);--rg-icon-pin-fill:hsl(122,39%,49%);--rg-icon-delete:hsl(4,90%,58%);--rg-icon-theme-sun:hsl(48,100%,41%);--rg-icon-theme-moon:hsl(207,89%,76%);--rg-hover-pin:hsla(122,39%,49%,.2);--rg-hover-delete:hsla(4,90%,58%,.2);--rg-hover-control:hsl(0,0%,92%);--rg-hover-control-btn:hsl(213,77%,96%);--rg-bg-card-pinned-voc:hsl(215,80%,95%);--rg-border-pinned-voc:hsl(215,80%,80%);--rg-bg-card-pinned-normal:hsl(130,50%,90%);--rg-border-pinned-normal:hsl(130,50%,70%);--rg-bg-card-pinned-abra:hsl(215,20%,90%);--rg-border-pinned-abra:hsl(215,20%,70%);--rg-bg-card-pinned-referats:hsl(80,55%,90%);--rg-border-pinned-referats:hsl(80,55%,70%);--rg-bg-card-pinned-noerror:hsl(200,45%,90%);--rg-border-pinned-noerror:hsl(200,45%,70%);--rg-bg-card-pinned-marathon:hsl(340,65%,90%);--rg-border-pinned-marathon:hsl(340,65%,70%);--rg-bg-card-pinned-chars:hsl(35,100%,90%);--rg-border-pinned-chars:hsl(35,100%,70%);--rg-bg-card-pinned-digits:hsl(0,0%,90%);--rg-border-pinned-digits:hsl(0,0%,70%);--rg-bg-card-pinned-sprint:hsl(5,40%,90%);--rg-border-pinned-sprint:hsl(5,40%,70%)}#latest-games-container.dark-theme{--rg-bg-primary:hsl(210,10%,11%);--rg-bg-secondary:hsl(220,10%,15%);--rg-bg-card:hsl(220,10%,15%);--rg-bg-card-pinned:hsl(140,20%,15%);--rg-bg-hover:hsl(220,10%,15%);--rg-border-primary:hsl(220,10%,15%);--rg-border-hover:hsl(0,0%,38%);--rg-border-pinned:hsl(133,43%,47%);--rg-text-primary:hsl(0,0%,88%);--rg-text-secondary:hsl(0,0%,88%);--rg-text-tertiary:hsl(0,0%,88%);--rg-text-options:hsl(0,0%,88%);--rg-text-count:#fc0;--rg-gametype-voc:hsl(215,80%,65%);--rg-gametype-normal:#6c7;--rg-gametype-abra:hsl(215,20%,60%);--rg-gametype-referats:hsl(80,55%,40%);--rg-gametype-noerror:hsl(200,45%,65%);--rg-gametype-marathon:hsl(340,70%,55%);--rg-gametype-chars:hsl(35,100%,45%);--rg-gametype-digits:hsl(0,0%,50%);--rg-gametype-sprint:hsl(5,40%,60%);--rg-icon-primary:hsl(207,89%,76%);--rg-icon-pin:hsl(133,43%,47%);--rg-icon-pin-fill:hsl(133,43%,47%);--rg-icon-delete:hsl(4,100%,75%);--rg-icon-theme-sun:#fc0;--rg-icon-theme-moon:hsl(207,89%,76%);--rg-hover-pin:hsla(133,43%,47%,.2);--rg-hover-delete:hsla(4,100%,75%,.2);--rg-hover-control:hsl(0,0%,38%);--rg-hover-control-btn:hsl(213,81.6%,29.8%);--rg-bg-card-pinned-voc:hsl(215,80%,10%);--rg-border-pinned-voc:hsl(215,80%,30%);--rg-bg-card-pinned-normal:hsl(130,50%,10%);--rg-border-pinned-normal:hsl(130,50%,30%);--rg-bg-card-pinned-abra:hsl(215,20%,10%);--rg-border-pinned-abra:hsl(215,20%,30%);--rg-bg-card-pinned-referats:hsl(80,55%,10%);--rg-border-pinned-referats:hsl(80,55%,30%);--rg-bg-card-pinned-noerror:hsl(200,45%,10%);--rg-border-pinned-noerror:hsl(200,45%,30%);--rg-bg-card-pinned-marathon:hsl(340,65%,10%);--rg-border-pinned-marathon:hsl(340,65%,30%);--rg-bg-card-pinned-chars:#320;--rg-border-pinned-chars:#960;--rg-bg-card-pinned-digits:hsl(0,0%,10%);--rg-border-pinned-digits:hsl(0,0%,30%);--rg-bg-card-pinned-sprint:hsl(5,40%,10%);--rg-border-pinned-sprint:hsl(5,40%,30%)}#latest-games-container.visible{left:0 !important;opacity:1;pointer-events:auto;user-select:auto}#latest-games-container.display-mode-wrap{max-width:none;width:calc(100vw - 100px);display:flex;flex-direction:row;flex-wrap:wrap;align-items:flex-start}#latest-games-container #latest-games{margin:0;padding:0;list-style:none;display:flex;flex-direction:column;gap:5px}#latest-games-container #latest-games.display-mode-wrap{display:flex;flex-direction:row;flex-wrap:wrap;width:100%;max-height:none;overflow-y:visible;margin:0 10px}#latest-games-container #latest-games.display-mode-wrap .latest-game{margin:0 !important}#latest-games-container #latest-games .latest-game{position:relative;margin:0 10px;border:1px solid var(--rg-border-primary);border-radius:4px !important;background-color:var(--rg-bg-card);transition:all .2s ease;display:inline-flex;flex:fit-content;max-width:300px}#latest-games-container #latest-games .latest-game.pin-game{cursor:move}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-voc{border:2px solid var(--rg-border-pinned-voc);background-color:var(--rg-bg-card-pinned-voc)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-normal{border:2px solid var(--rg-border-pinned-normal);background-color:var(--rg-bg-card-pinned-normal)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-abra{border:2px solid var(--rg-border-pinned-abra);background-color:var(--rg-bg-card-pinned-abra)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-referats{border:2px solid var(--rg-border-pinned-referats);background-color:var(--rg-bg-card-pinned-referats)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-noerror{border:2px solid var(--rg-border-pinned-noerror);background-color:var(--rg-bg-card-pinned-noerror)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-marathon{border:2px solid var(--rg-border-pinned-marathon);background-color:var(--rg-bg-card-pinned-marathon)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-chars{border:2px solid var(--rg-border-pinned-chars);background-color:var(--rg-bg-card-pinned-chars)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-digits{border:2px solid var(--rg-border-pinned-digits);background-color:var(--rg-bg-card-pinned-digits)}#latest-games-container #latest-games .latest-game.pin-game.pin-gametype-sprint{border:2px solid var(--rg-border-pinned-sprint);background-color:var(--rg-bg-card-pinned-sprint)}#latest-games-container #latest-games .latest-game:hover{border-color:var(--rg-border-hover);background-color:var(--rg-bg-hover);transform:translateX(2px)}#latest-games-container #latest-games .latest-game.dragging{opacity:.7;z-index:2000;transition:transform .1s ease}#latest-games-container #latest-games .latest-game.display-mode-wrap{margin:0}#latest-games-container #latest-games .latest-game a{display:block;width:100%;padding:8px 12px;text-decoration:none;color:inherit}#latest-games-container #latest-games .latest-game .latest-game-name{display:block;font-weight:bold;font-size:12px;margin-bottom:2px}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-voc{color:var(--rg-gametype-voc) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-normal{color:var(--rg-gametype-normal) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-abra{color:var(--rg-gametype-abra) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-referats{color:var(--rg-gametype-referats) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-noerror{color:var(--rg-gametype-noerror) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-marathon{color:var(--rg-gametype-marathon) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-chars{color:var(--rg-gametype-chars) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-digits{color:var(--rg-gametype-digits) !important}#latest-games-container #latest-games .latest-game .latest-game-name.gametype-sprint{color:var(--rg-gametype-sprint) !important}#latest-games-container #latest-games .latest-game .latest-game-description{display:block;font-size:10px;color:var(--rg-text-secondary);line-height:1.2}#latest-games-container #latest-games .latest-game .latest-game-qual{color:red;font-weight:bold}#latest-games-container #latest-games .latest-game .latest-game-levels{display:block;font-size:9px;color:var(--rg-text-tertiary);margin-top:1px}#latest-games-container #latest-games .latest-game .latest-game-buttons{position:relative;justify-content:center;display:flex;flex-direction:column;gap:2px;margin-right:5px;opacity:0;transition:opacity .2s ease;order:1}#latest-games-container #latest-games .latest-game:hover .latest-game-buttons{opacity:1}#latest-games-container #latest-games .latest-game .latest-game-pin,#latest-games-container #latest-games .latest-game .latest-game-delete{width:16px;height:16px;cursor:pointer;border-radius:2px !important;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease}#latest-games-container #latest-games .latest-game .latest-game-pin:hover,#latest-games-container #latest-games .latest-game .latest-game-delete:hover{background-color:var(--rg-hover-pin)}#latest-games-container #latest-games .latest-game .latest-game-pin svg,#latest-games-container #latest-games .latest-game .latest-game-delete svg{width:10px;height:10px;opacity:.6;stroke:var(--rg-icon-pin-fill)}#latest-games-container #latest-games .latest-game .latest-game-pin:hover svg,#latest-games-container #latest-games .latest-game .latest-game-delete:hover svg{opacity:1}#latest-games-container #latest-games .latest-game .latest-game-delete:hover{background-color:var(--rg-hover-delete)}#latest-games-container #latest-games .latest-game .latest-game-delete svg{stroke:var(--rg-icon-delete);fill:none}#latest-games-container .latest-games-controls{display:flex;justify-content:space-between;align-items:center;padding:0 10px;margin-top:10px}#latest-games-container #latest-games-options{display:flex;align-items:center;font-size:13px;gap:6px;color:var(--rg-text-options);user-select:none}#latest-games-container #latest-games-count{margin:0 6px;font-weight:bold;font-size:14px;min-width:18px;text-align:center;color:var(--rg-text-count)}#latest-games-container #latest-games-count-inc,#latest-games-container #latest-games-count-dec{height:24px;width:24px;cursor:pointer;font-size:16px;border-radius:3px !important;transition:background .15s;user-select:none;display:flex;align-items:center;justify-content:center;color:var(--rg-icon-primary)}#latest-games-container #latest-games-count-inc:hover,#latest-games-container #latest-games-count-dec:hover{background:var(--rg-hover-control-btn)}#latest-games-container #latest-games-count-inc svg,#latest-games-container #latest-games-count-dec svg{width:16px;height:16px}#latest-games-container .theme-toggle,#latest-games-container .display-mode-toggle,#latest-games-container .control-button{cursor:pointer;display:flex;align-items:center;justify-content:center;width:24px;height:24px;margin-left:6px;border-radius:4px;transition:background .15s;user-select:none}#latest-games-container .theme-toggle svg,#latest-games-container .display-mode-toggle svg,#latest-games-container .control-button svg{width:16px;height:16px;display:block;transition:stroke .2s,fill .2s}#latest-games-container .theme-toggle svg.feather-sun,#latest-games-container .display-mode-toggle svg.feather-sun,#latest-games-container .control-button svg.feather-sun{stroke:var(--rg-icon-theme-sun);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}#latest-games-container .theme-toggle svg.feather-moon,#latest-games-container .display-mode-toggle svg.feather-moon,#latest-games-container .control-button svg.feather-moon{stroke:var(--rg-icon-theme-moon);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}#latest-games-container .control-button{margin:0 2px;padding:0;box-sizing:border-box}#latest-games-container .control-button svg{pointer-events:none}#latest-games-hover-area{position:fixed;left:0;top:0;width:1px;height:100vh;z-index:3100;background-color:rgba(0,0,0,0);pointer-events:auto}',""]);const o=i},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a="",s=void 0!==t[5];return t[4]&&(a+="@supports (".concat(t[4],") {")),t[2]&&(a+="@media ".concat(t[2]," {")),s&&(a+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),a+=e(t),s&&(a+="}"),t[2]&&(a+="}"),t[4]&&(a+="}"),a})).join("")},t.i=function(e,a,s,n,r){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(s)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(i[l]=!0)}for(var g=0;g<e.length;g++){var m=[].concat(e[g]);s&&i[m[0]]||(void 0!==r&&(void 0===m[5]||(m[1]="@layer".concat(m[5].length>0?" ".concat(m[5]):""," {").concat(m[1],"}")),m[5]=r),a&&(m[2]?(m[1]="@media ".concat(m[2]," {").concat(m[1],"}"),m[2]=a):m[2]=a),n&&(m[4]?(m[1]="@supports (".concat(m[4],") {").concat(m[1],"}"),m[4]=n):m[4]="".concat(n)),t.push(m))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,a){var s=function(e){if(void 0===t[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(a)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(a){!function(e,t,a){var s="";a.supports&&(s+="@supports (".concat(a.supports,") {")),a.media&&(s+="@media ".concat(a.media," {"));var n=void 0!==a.layer;n&&(s+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),s+=a.css,n&&(s+="}"),a.media&&(s+="}"),a.supports&&(s+="}");var r=a.sourceMap;r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={id:s,exports:{}};return e[s](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.nc=void 0;const s={sun:'<svg xmlns="http://www.w3.org/2000/svg" class="feather feather-sun" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>',moon:'<svg xmlns="http://www.w3.org/2000/svg" class="feather feather-moon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round" class="feather feather-anchor"><circle cx="12" cy="5" r="3"></circle><line x1="12" y1="22" x2="12" y2="8"></line><path d="M5 12H2a10 10 0 0 0 20 0h-3"></path></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',decrease:'<svg viewBox="0 0 24 24"><path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" fill="currentColor"/></svg>',increase:'<svg viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" fill="currentColor"/></svg>',pinAll:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>',unpinAll:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 9.9-1"></path></svg>',import:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>',export:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>',removeAll:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>',wrap:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>',scroll:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/></svg>'};var n=a(72),r=a.n(n),i=a(825),o=a.n(i),l=a(659),g=a.n(l),m=a(56),c=a.n(m),d=a(540),h=a.n(d),p=a(113),u=a.n(p),v=a(100),y={};y.styleTagTransform=u(),y.setAttributes=c(),y.insert=g().bind(null,"head"),y.domAPI=o(),y.insertStyleElement=h();r()(v.A,y);v.A&&v.A.locals&&v.A.locals;function f(){return Array.from(crypto.getRandomValues(new Uint8Array(9))).map((e=>(e%36).toString(36))).join("")}class x{constructor(){this.maxGameCount=5,this.gameData=[],this.hoverTimeout=null,this.isHovered=!1,this.isDragging=!1,this.wasDragging=!1,this.dragThreshold=50,this.draggedElement=null,this.dragOffset={x:0,y:0},this.dragDirection=0,this.lastDragDirection=0,this.rotationAccumulator=0,this.rotationDegreeLimit=5,this.lastDragY=0,this.hidePanelDelay=3e3,this.globalEvents={},this.gameTypes={normal:"Oбычный",abra:"Абракадабра",referats:"Яндекс.Рефераты",noerror:"Безошибочный",marathon:"Марафон",chars:"Буквы",digits:"Цифры",sprint:"Спринт",voc:"По словарю"},this.visibilities={normal:"открытый",private:"дружеский",practice:"одиночный"},this.ranks=["новички","любители","таксисты","профи","гонщики","маньяки","супермены","кибергонщики","экстракиберы"],this.ranksMap={новичков:1,любителей:2,таксистов:3,профи:4,гонщиков:5,маньяков:6,суперменов:7,кибергонщиков:8,экстракиберов:9},this.currentTheme=localStorage.getItem("latest_games_theme")||"light",this.init()}init(){this.loadSettings(),this.loadGameData(),this.createHoverArea(),this.createContainer(),this.handlePageSpecificLogic(),this.exposeGlobalFunctions(),this.applyTheme()}applyTheme(){const e=document.getElementById("latest-games-container");e&&(e.classList.remove("light-theme","dark-theme"),e.classList.add(`${this.currentTheme}-theme`))}updateThemeIcon(e){e.innerHTML="light"===this.currentTheme?s.sun:s.moon}updateThemeToggle(){const e=document.querySelector("#latest-games-container .theme-toggle svg");e&&this.updateThemeIcon(e)}toggleTheme(){this.currentTheme="light"===this.currentTheme?"dark":"light",localStorage.setItem("latest_games_theme",this.currentTheme),this.applyTheme(),this.updateThemeToggle()}createThemeToggle(){const e=this.createElement("div",{className:"theme-toggle control-button",title:"Изменить тему (Светлая/Темная)"}),t=this.createElement("svg",{viewBox:"0 0 24 24"});return this.updateThemeIcon(t),e.appendChild(t),e.addEventListener("click",(()=>{this.toggleTheme()})),e}createDisplayModeToggle(){const e=this.getDisplayMode(),t=this.createElement("div",{className:"display-mode-toggle control-button",title:"Переключить режим отображения (Вертикальный/Горизонтальный)"}),a=this.createElement("svg",{viewBox:"0 0 24 24"});return this.updateDisplayModeIcon(a,e),t.appendChild(a),t.addEventListener("click",(()=>{const e="scroll"===this.getDisplayMode()?"wrap":"scroll";this.setDisplayMode(e),this.updateDisplayModeIcon(a,e),this.updateDisplayModeClass()})),t}getDisplayMode(){return localStorage.getItem("latest_games_display_mode")||"scroll"}setDisplayMode(e){localStorage.setItem("latest_games_display_mode",e)}updateDisplayModeIcon(e,t){e.innerHTML="wrap"===t?s.wrap:s.scroll}updateDisplayModeClass(){const e=document.getElementById("latest-games-container"),t=document.getElementById("latest-games");if(!e||!t)return;const a=this.getDisplayMode();e.classList.toggle("display-mode-wrap","wrap"===a),t.classList.toggle("display-mode-wrap","wrap"===a),this.updateContainerLeftOffset()}updateContainerLeftOffset(){const e=document.getElementById("latest-games-container");if(!e)return;const t=this.getDisplayMode();e.style.left="wrap"===t?"calc(-1 * (100vw - 100px))":"-350px"}createGameElement(e,t){const a=e.pin?` pin-gametype-${e.params.gametype}`:"",n=this.createElement("li",{className:`latest-game${e.pin?" pin-game":""}${a}`,id:`latest-game-${t}`}),r=this.createElement("div",{className:"latest-game-buttons"}),i=this.createElement("div",{className:"latest-game-pin",title:e.pin?"Открепить":"Закрепить",innerHTML:s.pin});i.addEventListener("click",(()=>this.pinGame(t)));const o=this.createElement("div",{className:"latest-game-delete",title:"Удалить",innerHTML:s.delete});o.addEventListener("click",(()=>this.deleteGame(t))),r.appendChild(i),r.appendChild(o);const l=this.createElement("a",{href:this.generateGameLink(e),innerHTML:this.generateGameName(e)});return l.addEventListener("click",(e=>{this.wasDragging&&(e.preventDefault(),this.wasDragging=!1)})),n.appendChild(r),n.appendChild(l),e.pin&&this.addDragFunctionality(n,t),n}createControls(){const e=this.createElement("div",{className:"latest-games-controls"}),t=this.createElement("span",{className:"latest-games-pinall control-button",title:"Закрепить все",innerHTML:s.pinAll});t.onclick=()=>{this.gameData.forEach((e=>e.pin=1)),this.saveGameData(),this.refreshContainer()};const a=this.createElement("span",{className:"latest-games-unpinall control-button",title:"Открепить все",innerHTML:s.unpinAll});a.onclick=()=>{this.gameData.forEach((e=>e.pin=0)),this.saveGameData(),this.refreshContainer()};const n=this.createElement("span",{className:"latest-games-import control-button",title:"Импортировать настройки из JSON файла",innerHTML:s.import});n.onclick=()=>{const e=document.createElement("input");e.type="file",e.accept=".json,application/json",e.style.display="none",e.onchange=async e=>{const t=e.target.files[0];if(t)try{const e=await t.text(),a=JSON.parse(e);"object"==typeof a&&null!==a?(a.latest_games&&localStorage.setItem("latest_games",JSON.stringify(a.latest_games)),a.latest_games_limit&&localStorage.setItem("latest_games_limit",a.latest_games_limit),a.latest_games_theme&&localStorage.setItem("latest_games_theme",a.latest_games_theme),a.latest_games_display_mode&&localStorage.setItem("latest_games_display_mode",a.latest_games_display_mode),a.latest_games_scroll&&localStorage.setItem("latest_games_scroll",a.latest_games_scroll),this.loadSettings(),this.loadGameData(),this.refreshContainer()):alert("Файл не содержит валидный JSON настроек.")}catch(e){alert("Ошибка при импорте: "+e)}},document.body.appendChild(e),e.click(),setTimeout((()=>e.remove()),1e3)};const r=this.createElement("span",{className:"latest-games-export control-button",title:"Экспортировать все настройки в JSON файл",innerHTML:s.export});r.onclick=()=>{const e={latest_games:JSON.parse(localStorage.getItem("latest_games")||"[]"),latest_games_limit:localStorage.getItem("latest_games_limit"),latest_games_theme:localStorage.getItem("latest_games_theme"),latest_games_display_mode:localStorage.getItem("latest_games_display_mode"),latest_games_scroll:localStorage.getItem("latest_games_scroll")},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="kg-latest-games-settings.json",document.body.appendChild(s),s.click(),setTimeout((()=>{URL.revokeObjectURL(a),s.remove()}),1e3)};const i=this.createElement("span",{className:"latest-games-removeall control-button",title:"Удалить все настройки",innerHTML:s.removeAll});i.onclick=()=>{localStorage.removeItem("latest_games"),localStorage.removeItem("latest_games_limit"),localStorage.removeItem("latest_games_scroll"),this.gameData=[],this.saveGameData(),this.refreshContainer()};const o=this.createElement("span",{id:"latest-games-options"}),l=this.createElement("span",{id:"latest-games-count-dec",className:"control-button",title:"Уменьшить количество сохраняемых игр",innerHTML:s.decrease}),g=this.createElement("span",{id:"latest-games-count",textContent:this.maxGameCount.toString()}),m=this.createElement("span",{id:"latest-games-count-inc",className:"control-button",title:"Увеличить количество сохраняемых игр",innerHTML:s.increase});return l.addEventListener("click",(()=>this.changeGameCount(-1))),m.addEventListener("click",(()=>this.changeGameCount(1))),o.appendChild(l),o.appendChild(g),o.appendChild(m),e.appendChild(o),e.appendChild(this.createThemeToggle()),e.appendChild(this.createDisplayModeToggle()),e.appendChild(t),e.appendChild(a),e.appendChild(n),e.appendChild(r),e.appendChild(i),e}createContainer(){const e=this.createElement("div",{id:"latest-games-container"}),t=this.createElement("ul",{id:"latest-games"});this.populateGamesList(t),e.appendChild(t);const a=this.createControls();e.appendChild(a);const s=localStorage.getItem("latest_games_scroll");s&&(e.scrollTop=parseInt(s,10)),e.addEventListener("scroll",(()=>{localStorage.setItem("latest_games_scroll",e.scrollTop.toString())})),e.addEventListener("mouseenter",(()=>{this.showContainer();const t=localStorage.getItem("latest_games_scroll");t&&(e.scrollTop=parseInt(t,10))})),e.addEventListener("mouseleave",(()=>{this.hideContainerWithDelay()})),document.body.appendChild(e),this.updateDisplayModeClass()}loadSettings(){try{const e=localStorage.getItem("latest_games_limit");e&&(this.maxGameCount=Math.max(0,parseInt(e,10)))}catch(e){console.warn("Could not load settings from localStorage:",e)}}loadGameData(){try{const e=localStorage.getItem("latest_games");e&&(this.gameData=JSON.parse(e),this.migrateOldGameData(),this.assignGameIds())}catch(e){console.warn("Could not load game data from localStorage:",e),this.gameData=[]}}migrateOldGameData(){this.gameData=this.gameData.map((e=>("on"!==e.params.qual&&""!==e.params.qual||(e.params.qual="on"===e.params.qual?1:0),e)))}assignGameIds(){this.gameData=this.gameData.map((e=>"id"in e&&-1!==e.id&&void 0!==e.id&&null!==e.id?e:{...e,id:f()}))}saveGameData(){try{localStorage.setItem("latest_games",JSON.stringify(this.gameData))}catch(e){console.warn("Could not save game data to localStorage:",e)}}saveSettings(){try{localStorage.setItem("latest_games_limit",this.maxGameCount.toString())}catch(e){console.warn("Could not save settings to localStorage:",e)}}createElement(e,t={}){const a=document.createElement(e);return t.className&&(a.className=t.className),t.id&&(a.id=t.id),t.innerHTML&&(a.innerHTML=t.innerHTML),t.textContent&&(a.textContent=t.textContent),t.href&&(a.href=t.href),t.title&&(a.title=t.title),t.src&&(a.src=t.src),t.style&&Object.assign(a.style,t.style),t.attributes&&Object.entries(t.attributes).forEach((([e,t])=>{a.setAttribute(e,t)})),a}generateGameName(e){const t=this.gameTypes[e.params.gametype],{vocName:a,timeout:s,type:n,level_from:r,level_to:i,qual:o}=e.params,l=this.createElement("span",{className:`latest-game-name gametype-${e.params.gametype}`,textContent:""===a?t:`«${a}»`}),g=this.createElement("span",{className:"latest-game-description"}),m=this.createElement("span",{className:"latest-game-qual",textContent:o?" (к)":""});let c="";if(1!==r||9!==i){c=` ${this.ranks[r-1]} - ${this.ranks[i-1]}`}const d=this.createElement("span",{className:"latest-game-levels",textContent:c});g.textContent=`${this.visibilities[n]}, ${s} сек.`,g.appendChild(m),c&&g.appendChild(d);const h=this.createElement("div");return h.appendChild(l),h.appendChild(g),h.innerHTML}generateGameLink(e){const{gametype:t,vocId:a,type:s,level_from:n,level_to:r,timeout:i,qual:o}=e.params,l=new URLSearchParams({gametype:t,type:s,level_from:n.toString(),level_to:r.toString(),timeout:i.toString(),submit:"1"});return""!==a&&l.set("voc",a),o&&l.set("qual","1"),`${location.protocol}//klavogonki.ru/create/?${l.toString()}`}addDragFunctionality(e){e.addEventListener("mousedown",(t=>{this.wasDragging=!1,this.initialX=t.clientX,this.initialY=t.clientY,this.isDragging=!0,this.draggedElement=e;const a=e.getBoundingClientRect(),s=t.clientX-a.left;this.isRightHalf=s>a.width/2,this.lastDragY=t.clientY,this.dragOffset={x:t.clientX-a.left,y:t.clientY-a.top},e.classList.add("dragging");"wrap"===this.getDisplayMode()&&(e.style.position="absolute",e.style.left=a.left-e.parentElement.getBoundingClientRect().left+"px",e.style.top=a.top-e.parentElement.getBoundingClientRect().top+"px",e.style.width=`${a.width}px`),this.globalEvents.handleDragMove=this.handleDragMove.bind(this),this.globalEvents.handleDragEnd=this.handleDragEnd.bind(this),document.addEventListener("mousemove",this.globalEvents.handleDragMove),document.addEventListener("mouseup",this.globalEvents.handleDragEnd)}))}handleDragMove(e){if(!this.isDragging||!this.draggedElement)return;this.wasDragging||(Math.abs(e.clientX-this.initialX)>this.dragThreshold||Math.abs(e.clientY-this.initialY)>this.dragThreshold)&&(this.wasDragging=!0),e.preventDefault();const t=this.getDisplayMode(),a=document.getElementById("latest-games");if("scroll"===t){const t=Array.from(a.querySelectorAll(".pin-game:not(.dragging)"));let s=null;for(const a of t){const t=a.getBoundingClientRect(),n=t.top+t.height/2;if(e.clientY<n)break;s=a}if(s)a.insertBefore(this.draggedElement,s.nextSibling);else{const e=a.querySelector(".pin-game:not(.dragging)");e&&a.insertBefore(this.draggedElement,e)}}else{const t=a.getBoundingClientRect();let s=e.clientX-this.dragOffset.x-t.left,n=e.clientY-this.dragOffset.y-t.top;s=Math.max(0,Math.min(s,a.offsetWidth-this.draggedElement.offsetWidth)),n=Math.max(0,Math.min(n,a.offsetHeight-this.draggedElement.offsetHeight)),this.draggedElement.style.left=`${s}px`,this.draggedElement.style.top=`${n}px`;const r=Array.from(a.querySelectorAll(".pin-game:not(.dragging)"));let i=null,o=1/0;const l=e.clientX,g=e.clientY;if(r.forEach((e=>{const t=e.getBoundingClientRect(),a=t.left+t.width/2,s=t.top+t.height/2,n=Math.hypot(l-a,g-s);n<o&&(o=n,i=e)})),i){const e=i.getBoundingClientRect();l<e.left+e.width/2?a.insertBefore(this.draggedElement,i):a.insertBefore(this.draggedElement,i.nextSibling)}}const s=e.clientY,n=s-this.lastDragY;if(this.lastDragY=s,0!==n){const e=.2;this.rotationAccumulator=(this.rotationAccumulator||0)+(this.isRightHalf?n:-n)*e,this.rotationAccumulator>this.rotationDegreeLimit?this.rotationAccumulator=this.rotationDegreeLimit:this.rotationAccumulator<-this.rotationDegreeLimit&&(this.rotationAccumulator=-this.rotationDegreeLimit),this.draggedElement.style.transform=`rotate(${this.rotationAccumulator}deg)`}}handleDragEnd(){if(!this.isDragging||!this.draggedElement)return;this.isDragging=!1,this.draggedElement.classList.remove("dragging");"wrap"===this.getDisplayMode()&&(this.draggedElement.style.position="",this.draggedElement.style.left="",this.draggedElement.style.top="",this.draggedElement.style.width=""),this.draggedElement.style.transform="",this.updateGameOrderFromDOM(),this.draggedElement=null,this.dragDirection=0,this.lastDragY=0,this.globalEvents&&(document.removeEventListener("mousemove",this.globalEvents.handleDragMove),document.removeEventListener("mouseup",this.globalEvents.handleDragEnd))}updateGameOrderFromDOM(){const e=Array.from(document.querySelectorAll("#latest-games .latest-game")),t=[];e.forEach((e=>{const a=e.id.replace("latest-game-",""),s=this.gameData.find((e=>e.id===a));s&&t.push(s)})),this.gameData=t,this.assignGameIds(),this.saveGameData()}getPinnedGameCount(){return this.gameData.filter((e=>e.pin)).length}createHoverArea(){const e=this.createElement("div",{id:"latest-games-hover-area"});e.addEventListener("mouseenter",(()=>{this.showContainer()})),e.addEventListener("mouseleave",(()=>{this.hideContainerWithDelay()})),document.body.appendChild(e)}populateGamesList(e){e.innerHTML="";const t=this.getPinnedGameCount(),a=Math.min(this.gameData.length,this.maxGameCount+t);for(let t=0;t<a;t++){const a=this.gameData[t],s=this.createGameElement(a,a.id);e.appendChild(s)}}showContainer(){this.isHovered=!0,this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null);const e=document.getElementById("latest-games-container");if(e){e.classList.add("visible"),e.style.left="0";const t=localStorage.getItem("latest_games_scroll");null!==t&&(e.scrollTop=parseInt(t,10)||0)}}hideContainerWithDelay(){this.isHovered=!1,this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.hoverTimeout=setTimeout((()=>{if(!this.isHovered){const e=document.getElementById("latest-games-container");e&&(e.classList.remove("visible"),this.updateContainerLeftOffset())}}),this.hidePanelDelay)}refreshContainer(){const e=document.getElementById("latest-games");e&&(this.populateGamesList(e),this.updateDisplayModeClass())}findGameIndex(e){return this.gameData.findIndex((t=>t.id==e))}deleteGame(e){const t=this.findGameIndex(e);if(-1===t)return null;const a=this.gameData.splice(t,1)[0];return this.assignGameIds(),this.saveGameData(),this.refreshContainer(),a}pinGame(e){const t=this.findGameIndex(e);if(-1===t)return;const a=this.gameData[t];a.pin=a.pin?0:1;const s=a.pin?this.gameData.findIndex((e=>!e.pin||e===a)):this.gameData.findIndex((e=>!e.pin&&e!==a));if(t!==s){const[e]=this.gameData.splice(t,1);this.gameData.splice(s,0,e)}this.assignGameIds(),this.saveGameData(),this.refreshContainer()}saveCurrentGameParams(){const e=document.getElementById("gamedesc");if(!e)throw new Error("#gamedesc element not found.");const t=e.querySelector("span");if(!t)throw new Error("#gamedesc span element not found.");const a=e.textContent;if(/соревнование/.test(a)||!this.maxGameCount)return!1;const s=this.parseGameParams(t,a),n=JSON.stringify(s);for(let e=0;e<this.gameData.length;e++)if(JSON.stringify(this.gameData[e].params)===n){if(this.gameData[e].pin)return;this.gameData.splice(e,1);break}const r=this.getPinnedGameCount();for(;this.gameData.length>=this.maxGameCount+r;)this.gameData.pop();const i={params:s,id:f(),pin:0};this.gameData.splice(r,0,i),this.assignGameIds(),this.saveGameData()}parseGameParams(e,t){const a=e.className.split("-").pop(),s="voc"===a?e.textContent.replace(/[«»]/g,""):"";let n="";if("voc"===a){const t=e.querySelector("a");if(t){const e=t.href.match(/vocs\/(\d+)/);n=e?parseInt(e[1],10):""}}let r="normal";/одиночный/.test(t)?r="practice":/друзьями/.test(t)&&(r="private");let i=1,o=9;const l=t.match(/для (\S+)–(\S+),/);l&&(i=this.ranksMap[l[1]]||1,o=this.ranksMap[l[2]]||9);const g=t.match(/таймаут\s(\d+)\s(сек|мин)/);return{gametype:a,vocName:s,vocId:n,type:r,level_from:i,level_to:o,timeout:g?"сек"===g[2]?parseInt(g[1],10):60*parseInt(g[1],10):60,qual:/квалификация/.test(t)?1:0,premium_abra:0}}changeGameCount(e){e<0&&this.maxGameCount>0?this.maxGameCount--:e>0&&this.maxGameCount++;const t=document.getElementById("latest-games-count");t&&(t.textContent=this.maxGameCount.toString()),this.saveSettings(),this.refreshContainer()}handlePageSpecificLogic(){const{href:e}=location;if(/https?:\/\/klavogonki\.ru\/g\/\?gmid=/.test(e)){const e=document.getElementById("gameloading");if(!e)throw new Error("#gameloading element not found.");if("none"!==e.style.display){const t=new MutationObserver((()=>{t.disconnect(),this.saveCurrentGameParams()}));t.observe(e,{attributes:!0})}else this.saveCurrentGameParams()}}exposeGlobalFunctions(){window.latestGamesManager=this}}!function(){if(!document.getElementById("kg-latest-games-montserrat-font")){const e=document.createElement("link");e.id="kg-latest-games-montserrat-font",e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap",document.head.appendChild(e)}}(),function(){if(!document.getElementById("KG_LatestGames")){new x;const e=document.createElement("div");e.id="KTS_LatestGames",e.style.display="none",document.body.appendChild(e)}}()})();